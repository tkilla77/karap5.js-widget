(()=>{"use strict";var e={5339:(e,t,r)=>{function n(e,t="Error"){if(!e)throw new Error(t)}r.r(t),r.d(t,{Cell:()=>h,Cells:()=>u,Coordinates:()=>s,Direction:()=>c,Directions:()=>l,Grid:()=>f,Kara:()=>p,KaraRecorder:()=>g,KaraStepper:()=>m,KaraWorld:()=>y});class o extends Error{constructor(e){super(e),this.name=this.constructor.name}}class i extends Error{constructor(e){super(e),this.name=this.constructor.name}}const a=[8,8];class s{static fromXy(e,t){return new s(e,t)}static fromCopy(e){return new s(e.x,e.y)}constructor(e,t){this.x=e,this.y=t}add(e){return s.fromXy(this.x+e.x,this.y+e.y)}move(e){return e.apply(this)}toString(){return`[${this.x}, ${this.y}]`}}class c{constructor(e,t,r,n){this.name=e,this.coords=s.fromXy(t,r),this.angle=n}apply(e){return e.add(this.coords)}toString(){return this.name}}const l=function(){let e=new c("‚Üë",0,-1,0),t=new c("‚Üì",0,1,Math.PI),r=new c("‚Üí",1,0,Math.PI/2),n=new c("‚Üê",-1,0,-Math.PI/2);return e.left=n,e.right=r,n.left=t,n.right=e,t.left=r,t.right=n,r.left=e,r.right=t,Object.freeze({UP:e,DOWN:t,RIGHT:r,LEFT:n})}();class h{static fromString(e){switch(e){case" ":case"_":return u.EMPTY;case"T":case"üå≥":return u.TREE;case"B":case"üêû":return u.BUG;case"M":case"üçÑ":return u.MUSHROOM;case"C":case"üçÄ":return u.CLOVER;default:return new h(e,e)}}constructor(e="?",t=EMPTY){this.display=e,this.type=t}draw(e,t){text(this.display,e,t)}toString(){return this.type}}const u=Object.freeze({EMPTY:new h(" ","_"),TREE:new h("üå≥","T"),BUG:new h("üêû","B"),MUSHROOM:new h("üçÑ","M"),CLOVER:new h("üçÄ","C")}),d="TTTTTTTTT\n   T       T\n   T       T\n   T       T\n   T       T\n   T       T\n   T       T\n   T       T\n   TTTTTTTTT";class f{static copy(e){return f.fromStringSpec(e.toString())}static fromStringSpec(e){let t=e.split(/\r?\n/g);for(let e=0;e<t.length;e++)t[e]=t[e].trim();return f.fromStringArray(t)}static fromStringArray(e){let t=[...e[0]].length,r=e.length,o=new f([t,r]),i=0;for(let r of e){n([...r].length==t,`Unexpected grid spec, line ${i} has length ${[...r].length}, expected ${t} `);let e=0;for(let t of r){let r=h.fromString(t),n=s.fromXy(e,i);o.set(n,r),e++}i++}return o}constructor(e=a){n(e[0]>=1&&e[1]>=1,`unexpected grid size: ${e}`),this.size=[...e];let t=Array(this.size[0]).fill(u.EMPTY);this.grid=Array(this.size[1]);for(let e=0;e<this.grid.length;e++)this.grid[e]=Array.from(t)}findKara(){let e,t;for(let r=0;r<this.grid.length;r++){let n=this.grid[r];for(let o=0;o<n.length;o++){let n=s.fromXy(o,r),i=this.at(n);if(i!=u.EMPTY||t||(t=n),!e)switch(i.type){case"<":e=new p(this,n,l.LEFT);break;case"^":e=new p(this,n,l.UP);break;case">":e=new p(this,n,l.RIGHT);break;case"V":case"v":e=new p(this,n,l.DOWN)}switch(i.type){case"<":case"^":case">":case"V":case"v":this.clear(n)}}}return!e&&t&&(e=new p(this,t,c.RIGHT)),e}at(e){return this.grid[e.y][e.x]}set(e,t){this.grid[e.y][e.x]=t}clear(e){this.grid[e.y][e.x]=u.EMPTY}draw(e=25){push(),stroke("rgba(115,115,115,0.5)"),textAlign(CENTER,CENTER);for(let t=0;t<this.grid.length;t++){let r=this.grid[t];for(let n=0;n<r.length;n++){let r=this.at(s.fromXy(n,t));push(),translate(n*e,t*e),square(0,0,e),translate(.5*e,.5*e),r.draw(0,0),pop()}}pop()}gridSize(){return s.fromXy(this.grid[0].length,this.grid.length)}toString(){return this.grid.map((e=>e.map((e=>e.toString())).join(""))).join("\n")}}class p{constructor(e,t=s.fromXy(1,1),r=l.RIGHT){this.grid=e,this.direction=r,this.coords=s.fromCopy(t)}draw(e){push(),translate((this.coords.x+.5)*e,(this.coords.y+.5)*e),rotate(this.direction.angle),textAlign(CENTER,CENTER),text(u.BUG.display,0,0),pop()}_cell(e){try{return this.grid.at(e)}catch(e){return}}treeFront(){return this._cell(this.direction.apply(this.coords))==u.TREE}treeLeft(){return this._cell(this.direction.left.apply(this.coords))==u.TREE}treeRight(){return this._cell(this.direction.right.apply(this.coords))==u.TREE}mushroomFront(){return this._cell(this.direction.apply(this.coords))==u.MUSHROOM}onLeaf(){return this._cell(this.coords)==u.CLOVER}_isMoveableDestination(e){let t=this._cell(e);return null!=t&&t!=u.TREE}_canMove(e=void 0){return e||(e=this.direction),this._isMoveableDestination(this.coords.move(e))}move(){if(!this._canMove())throw new o(`Unable to move from ${this.coords} in direction ${this.direction}!`);this.coords=this.coords.move(this.direction)}turnLeft(){this.direction=this.direction.left}turnRight(){this.direction=this.direction.right}putLeaf(){this.grid.set(this.coords,u.CLOVER)}removeLeaf(){this.grid.at(this.coords)==u.CLOVER&&this.grid.clear(this.coords)}}class m{constructor(e,t=500){this.kara=e,this.delay=t}sleeper(){return new Promise((e=>setTimeout((()=>e()),this.delay)))}treeFront(){return this.kara.treeFront()}treeLeft(){return this.kara.treeLeft()}treeRight(){return this.kara.treeRight()}mushroomFront(){return this.kara.mushroomFront()}onLeaf(){return this.kara.onLeaf()}async move(){await this.sleeper(),this.kara.move()}async turnLeft(){await this.sleeper(),this.kara.turnLeft()}async turnRight(){await this.sleeper(),this.kara.turnRight()}async putLeaf(){await this.sleeper(),this.kara.putLeaf()}async removeLeaf(){await this.sleeper(),this.kara.removeLeaf()}}class g{constructor(e,t=50){this.kara=e,this.commands=Array(),this.maxCommands=t}async replay(e){for(let t of this.commands)await e[t]()}record(e){if(this.commands.length>this.maxCommands)throw new i(`Stopped recording after ${this.maxCommands} commands.`);this.commands.push(e)}treeFront(){return this.kara.treeFront()}treeLeft(){return this.kara.treeLeft()}treeRight(){return this.kara.treeRight()}mushroomFront(){return this.kara.mushroomFront()}onLeaf(){return this.kara.onLeaf()}move(){this.record(this.move.name),this.kara.move()}turnLeft(){this.record(this.turnLeft.name),this.kara.turnLeft()}turnRight(){this.record(this.turnRight.name),this.kara.turnRight()}putLeaf(){this.record(this.putLeaf.name),this.kara.putLeaf()}removeLeaf(){this.record(this.removeLeaf.name),this.kara.removeLeaf()}}class y{static create(e=d,t=25,r=!0,n=!0){let o=y.fromStringSpec(e);if(r){let e=o.grid.gridSize();window.setup=()=>{createCanvas(e.x*t,e.y*t),o.executeKara()},window.draw=()=>{o.draw(t)},window.kara=o.getRecorder()}return n&&(window.keyPressed=()=>o.keyPressed()),o}static fromStringSpec(e=d){let t=f.fromStringSpec(e);return new y(t,t.findKara())}constructor(e,t){this.grid=e,this.kara=t;let r=f.copy(this.grid),n=Object.create(this.kara);n.grid=r,this.recorder=new g(n)}draw(e){push(),textSize(.8*e),this.grid.draw(e),this.kara.draw(e),pop()}getRecorder(){return this.recorder}async executeKara(e=500,t="my_kara",r=50){let n;this.recorder.maxCommands=r;try{"string"==typeof t&&(t=window[t]),"function"==typeof t?t(this.recorder):console.log(`Not a valid client function: ${t}`)}catch(e){(e instanceof o||e instanceof i)&&(n=e)}let a=new m(this.kara,e);return this.recorder.replay(a).catch((e=>{if(e instanceof o||e instanceof i)throw n}))}keyPressed(){return keyCode==UP_ARROW?(event&&event.preventDefault(),this.kara.move(),!1):keyCode==LEFT_ARROW?(event&&event.preventDefault(),this.kara.turnLeft(),!1):keyCode==RIGHT_ARROW?(event&&event.preventDefault(),this.kara.turnRight(),!1):keyCode==DOWN_ARROW?(event&&event.preventDefault(),this.kara.onLeaf()?this.kara.removeLeaf():this.kara.putLeaf(),!1):void 0}}},650:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(1354),o=r.n(n),i=r(6314),a=r.n(i)()(o());a.push([e.id,"html, body {\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  display: flex;\n\n  /* This centers our sketch horizontally. */\n  justify-content: center;\n\n  /* This centers our sketch vertically. */\n  align-items: center;\n}\n","",{version:3,sources:["webpack://./css/preview-frame.css"],names:[],mappings:"AAAA;EACE,YAAY;AACd;;AAEA;EACE,SAAS;EACT,aAAa;;EAEb,0CAA0C;EAC1C,uBAAuB;;EAEvB,wCAAwC;EACxC,mBAAmB;AACrB",sourcesContent:["html, body {\n  height: 100%;\n}\n\nbody {\n  margin: 0;\n  display: flex;\n\n  /* This centers our sketch horizontally. */\n  justify-content: center;\n\n  /* This centers our sketch vertically. */\n  align-items: center;\n}\n"],sourceRoot:""}]);const s=a},6314:e=>{e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r="",n=void 0!==t[5];return t[4]&&(r+="@supports (".concat(t[4],") {")),t[2]&&(r+="@media ".concat(t[2]," {")),n&&(r+="@layer".concat(t[5].length>0?" ".concat(t[5]):""," {")),r+=e(t),n&&(r+="}"),t[2]&&(r+="}"),t[4]&&(r+="}"),r})).join("")},t.i=function(e,r,n,o,i){"string"==typeof e&&(e=[[null,e,void 0]]);var a={};if(n)for(var s=0;s<this.length;s++){var c=this[s][0];null!=c&&(a[c]=!0)}for(var l=0;l<e.length;l++){var h=[].concat(e[l]);n&&a[h[0]]||(void 0!==i&&(void 0===h[5]||(h[1]="@layer".concat(h[5].length>0?" ".concat(h[5]):""," {").concat(h[1],"}")),h[5]=i),r&&(h[2]?(h[1]="@media ".concat(h[2]," {").concat(h[1],"}"),h[2]=r):h[2]=r),o&&(h[4]?(h[1]="@supports (".concat(h[4],") {").concat(h[1],"}"),h[4]=o):h[4]="".concat(o)),t.push(h))}},t}},1354:e=>{e.exports=function(e){var t=e[1],r=e[3];if(!r)return t;if("function"==typeof btoa){var n=btoa(unescape(encodeURIComponent(JSON.stringify(r)))),o="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(n),i="/*# ".concat(o," */");return[t].concat([i]).join("\n")}return[t].join("\n")}},6317:(e,t,r)=>{r.r(t),r.d(t,{default:()=>y});var n=r(5072),o=r.n(n),i=r(7825),a=r.n(i),s=r(7659),c=r.n(s),l=r(5056),h=r.n(l),u=r(540),d=r.n(u),f=r(1113),p=r.n(f),m=r(650),g={};g.styleTagTransform=p(),g.setAttributes=h(),g.insert=c().bind(null,"head"),g.domAPI=a(),g.insertStyleElement=d(),o()(m.A,g);const y=m.A&&m.A.locals?m.A.locals:void 0},5072:e=>{var t=[];function r(e){for(var r=-1,n=0;n<t.length;n++)if(t[n].identifier===e){r=n;break}return r}function n(e,n){for(var i={},a=[],s=0;s<e.length;s++){var c=e[s],l=n.base?c[0]+n.base:c[0],h=i[l]||0,u="".concat(l," ").concat(h);i[l]=h+1;var d=r(u),f={css:c[1],media:c[2],sourceMap:c[3],supports:c[4],layer:c[5]};if(-1!==d)t[d].references++,t[d].updater(f);else{var p=o(f,n);n.byIndex=s,t.splice(s,0,{identifier:u,updater:p,references:1})}a.push(u)}return a}function o(e,t){var r=t.domAPI(t);return r.update(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap&&t.supports===e.supports&&t.layer===e.layer)return;r.update(e=t)}else r.remove()}}e.exports=function(e,o){var i=n(e=e||[],o=o||{});return function(e){e=e||[];for(var a=0;a<i.length;a++){var s=r(i[a]);t[s].references--}for(var c=n(e,o),l=0;l<i.length;l++){var h=r(i[l]);0===t[h].references&&(t[h].updater(),t.splice(h,1))}i=c}}},7659:e=>{var t={};e.exports=function(e,r){var n=function(e){if(void 0===t[e]){var r=document.querySelector(e);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}t[e]=r}return t[e]}(e);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},540:e=>{e.exports=function(e){var t=document.createElement("style");return e.setAttributes(t,e.attributes),e.insert(t,e.options),t}},5056:(e,t,r)=>{e.exports=function(e){var t=r.nc;t&&e.setAttribute("nonce",t)}},7825:e=>{e.exports=function(e){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var t=e.insertStyleElement(e);return{update:function(r){!function(e,t,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),t.styleTagTransform(n,e,t.options)}(t,e,r)},remove:function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(t)}}}},1113:e=>{e.exports=function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}}},2213:function(e,t,r){var n=this&&this.__createBinding||(Object.create?function(e,t,r,n){void 0===n&&(n=r);var o=Object.getOwnPropertyDescriptor(t,r);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[r]}}),Object.defineProperty(e,n,o)}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return o(t,e),t};Object.defineProperty(t,"__esModule",{value:!0});const a=i(r(5339));r(6317);let s=window;s.startSketch=function(e,t,r,n,o,i){let c=document.createElement("script"),l=function(e,t,r){let n={wasTriggered:!1,getLineNumber(){let t=i[0],r=1;for(let n=0;n<t;n++)"\n"===e[n]&&r++;return r}},o=Date.now(),i=null;return s[t]=e=>{if(Date.now()-o>r)throw n.wasTriggered=!0,i=e,new Error("Loop took over "+r+" ms to run")},setInterval((()=>{o=Date.now()}),r/2),n}(e,n,r);var h,u,d;o&&(h=o,(u=document.createElement("base")).setAttribute("href",h),document.head.appendChild(u)),c.textContent=e,s.addEventListener("error",(e=>{let t,r=e.message;if(e.error&&(r=e.error.message),l.wasTriggered)r="Your loop is taking too long to run.",t=l.getLineNumber();else if(e.error&&e.error.stack){let r=e.error.stack.match(/my_kara \(<anonymous>:(\d+):\d+\)/);r&&r.length>1&&(t=parseInt(r[1]))}else"number"!=typeof e.lineno||""!==e.filename&&e.filename!==window.location.href||(t=e.lineno);i(r,t)})),s.addEventListener("unhandledrejection",(e=>{reportError(e.reason)})),function(e,t){t=t||(()=>{});let r=0,n=()=>{if(r===e.length)return t();!function(e,t){let r=document.createElement("script");t=t||(()=>{}),r.onload=t,r.onerror=()=>{console.log("Failed to load script: "+e)},r.setAttribute("src",e),document.body.appendChild(r)}(e[r++],n)};n()}([(d=t,`//cdnjs.cloudflare.com/ajax/libs/p5.js/${d}/p5.js`)],(()=>{!function(){for(let e of Object.keys(a))console.log(`Adding ${e} to globals`),s[e]=a[e]}(),document.body.appendChild(c),"complete"===document.readyState&&new s.p5}))}}},t={};function r(n){var o=t[n];if(void 0!==o)return o.exports;var i=t[n]={id:n,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nc=void 0,r(2213)})();
//# sourceMappingURL=preview-frame.bundle.js.map